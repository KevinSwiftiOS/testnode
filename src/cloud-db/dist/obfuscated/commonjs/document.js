'use strict';const a12_0x1a2f96=a12_0x2f05;function a12_0x2f05(_0x57d1b0,_0x46a788){const _0x488579=a12_0x4885();return a12_0x2f05=function(_0x2f055b,_0xb3b5d8){_0x2f055b=_0x2f055b-0xef;let _0x4959f7=_0x488579[_0x2f055b];return _0x4959f7;},a12_0x2f05(_0x57d1b0,_0x46a788);}(function(_0x63515a,_0x8c5df7){const _0x204a60=a12_0x2f05,_0x1c77fc=_0x63515a();while(!![]){try{const _0x167fba=-parseInt(_0x204a60(0x123))/0x1+-parseInt(_0x204a60(0x11a))/0x2*(parseInt(_0x204a60(0x117))/0x3)+parseInt(_0x204a60(0x10f))/0x4*(parseInt(_0x204a60(0x115))/0x5)+parseInt(_0x204a60(0x102))/0x6*(parseInt(_0x204a60(0x11f))/0x7)+parseInt(_0x204a60(0x124))/0x8*(parseInt(_0x204a60(0x11d))/0x9)+parseInt(_0x204a60(0x108))/0xa+parseInt(_0x204a60(0x126))/0xb*(parseInt(_0x204a60(0xf7))/0xc);if(_0x167fba===_0x8c5df7)break;else _0x1c77fc['push'](_0x1c77fc['shift']());}catch(_0x58ffcc){_0x1c77fc['push'](_0x1c77fc['shift']());}}}(a12_0x4885,0x1e5e9));function a12_0x4885(){const _0x2256e5=['updated','deleted','formatRequestServerDateParams','DocumentReference','list','_request','toString','QueryType','remove','_coll','update','./serializer/update','serialize','slice','defineProperty','baseDb','DataBaseError','84zIdysA','keys','Object','./util','database.getDocument','prototype','DOC','./constant','assign','bson','ErrorMsg','255414boAeKg','send','request_id','stringifyByEJSON','UPDATE_PARAM_HAS_ID_ERROR','call','72260wNFZsJ','string','INVALID_PARAM','ERRORS','SET_PARAM_OBJECT_ERROR','database.updateDocument','encodeEJSON','165256cnhbda','config','_id','Util','_db','reqClass','10HBNbmL','EJSON','59451TUaNdr','map','hasOwnProperty','24XtPyhx','./basedb','doc','252tzKDHZ','set','7IWgnoi','get','__esModule','database.removeDocument','166531fEiJUh','11760hZVOry','SET_PARAM_HAS_ID_ERROR','558085gCwgvR','UPDATE_PARAM_ERROR'];a12_0x4885=function(){return _0x2256e5;};return a12_0x4885();}Object[a12_0x1a2f96(0xf4)](exports,a12_0x1a2f96(0x121),{'value':!![]}),exports[a12_0x1a2f96(0x12b)]=void 0x0;const bson_1=require(a12_0x1a2f96(0x100)),basedb_1=require(a12_0x1a2f96(0x11b)),constant_1=require(a12_0x1a2f96(0xfe)),Errors_1=require('./Errors'),datatype_1=require('./serializer/datatype'),update_1=require(a12_0x1a2f96(0xf1)),util_1=require(a12_0x1a2f96(0xfa)),util_2=require(a12_0x1a2f96(0xfa));class DocumentReference{constructor(_0xc170c8,_0x5cd912,_0x33e582){const _0x499834=a12_0x1a2f96;this[_0x499834(0x113)]=_0xc170c8,this['_coll']=_0x5cd912,this['id']=_0x33e582,this['_request']=new basedb_1[(_0x499834(0xf5))][(_0x499834(0x114))](this[_0x499834(0x113)][_0x499834(0x110)]);}async[a12_0x1a2f96(0x120)](){const _0x300af5=a12_0x1a2f96;var _0x262399,_0x9309af;const _0x3e99d4=(0x0,util_2[_0x300af5(0x105)])({'_id':this['id']}),_0x2465b3={'collection_name':this[_0x300af5(0xef)],'query':_0x3e99d4,'query_type':constant_1[_0x300af5(0x12f)][_0x300af5(0xfd)],'multi':![]},_0x4c55ef=await this[_0x300af5(0x12d)][_0x300af5(0x103)](_0x300af5(0xfb),_0x2465b3),_0xac23c4=(_0x262399=_0x4c55ef===null||_0x4c55ef===void 0x0?void 0x0:_0x4c55ef[_0x300af5(0x12c)])===null||_0x262399===void 0x0?void 0x0:_0x262399[_0x300af5(0x118)](_0x47f50e=>bson_1[_0x300af5(0x116)]['parse'](_0x47f50e)),_0x45d53c=util_1[_0x300af5(0x112)]['formatResDocumentData'](_0xac23c4!==null&&_0xac23c4!==void 0x0?_0xac23c4:[]);return{'data':_0x45d53c,'requestId':(_0x9309af=_0x4c55ef===null||_0x4c55ef===void 0x0?void 0x0:_0x4c55ef[_0x300af5(0x104)])!==null&&_0x9309af!==void 0x0?_0x9309af:''};}async[a12_0x1a2f96(0x11e)](_0x20a74e){const _0xb21e59=a12_0x1a2f96;var _0x45bec7,_0x12890b;if(typeof this['id']!==_0xb21e59(0x109)||this['id']==='')throw new Errors_1[(_0xb21e59(0xf6))](Object['assign'](Object['assign']({},Errors_1[_0xb21e59(0x10b)][_0xb21e59(0x10a)]),{'errMsg':Errors_1[_0xb21e59(0x101)][_0xb21e59(0x11c)][_0xb21e59(0x11e)]['SET_PARAM_ERROR']}));if(!(_0x20a74e&&Object[_0xb21e59(0xfc)][_0xb21e59(0x12e)]['call'](_0x20a74e)[_0xb21e59(0xf3)](0x8,-0x1)!==_0xb21e59(0xf9)&&Object[_0xb21e59(0xf8)](_0x20a74e)['length']>0x0))throw new Errors_1[(_0xb21e59(0xf6))](Object[_0xb21e59(0xff)](Object[_0xb21e59(0xff)]({},Errors_1[_0xb21e59(0x10b)]['INVALID_PARAM']),{'errMsg':Errors_1[_0xb21e59(0x101)][_0xb21e59(0x11c)][_0xb21e59(0x11e)][_0xb21e59(0x10c)]}));if((0x0,util_2[_0xb21e59(0x119)])(_0x20a74e,_0xb21e59(0x111)))throw new Errors_1[(_0xb21e59(0xf6))](Object['assign'](Object[_0xb21e59(0xff)]({},Errors_1[_0xb21e59(0x10b)][_0xb21e59(0x10a)]),{'errMsg':Errors_1[_0xb21e59(0x101)][_0xb21e59(0x11c)][_0xb21e59(0x11e)][_0xb21e59(0x125)]}));let _0x2ad881={'collection_name':this[_0xb21e59(0xef)],'query_type':constant_1[_0xb21e59(0x12f)][_0xb21e59(0xfd)],'update_data':(0x0,util_2[_0xb21e59(0x105)])((0x0,datatype_1[_0xb21e59(0xf2)])(_0x20a74e)),'multi':![],'merge':![],'upsert':!![]};this['id']&&(_0x2ad881=Object[_0xb21e59(0xff)](_0x2ad881,{'query':(0x0,util_2[_0xb21e59(0x105)])({'_id':this['id']})}));const _0x518cab=await this['_request'][_0xb21e59(0x103)](_0xb21e59(0x10d),(0x0,util_1[_0xb21e59(0x12a)])(_0x2ad881));return{'updated':(_0x45bec7=_0x518cab===null||_0x518cab===void 0x0?void 0x0:_0x518cab[_0xb21e59(0x128)])!==null&&_0x45bec7!==void 0x0?_0x45bec7:0x0,'requestId':(_0x12890b=_0x518cab===null||_0x518cab===void 0x0?void 0x0:_0x518cab[_0xb21e59(0x104)])!==null&&_0x12890b!==void 0x0?_0x12890b:''};}async[a12_0x1a2f96(0xf0)](_0x149453){const _0x42ab4b=a12_0x1a2f96;var _0x51c7e7,_0x42cd6e;if(typeof this['id']!==_0x42ab4b(0x109)||this['id']==='')throw new Errors_1[(_0x42ab4b(0xf6))](Object[_0x42ab4b(0xff)](Object[_0x42ab4b(0xff)]({},Errors_1[_0x42ab4b(0x10b)][_0x42ab4b(0x10a)]),{'errMsg':Errors_1[_0x42ab4b(0x101)]['doc']['update'][_0x42ab4b(0x127)]}));if(!(_0x149453&&Object[_0x42ab4b(0xfc)]['toString'][_0x42ab4b(0x107)](_0x149453)[_0x42ab4b(0xf3)](0x8,-0x1)!==_0x42ab4b(0xf9)&&Object[_0x42ab4b(0xf8)](_0x149453)['length']>0x0))throw new Errors_1[(_0x42ab4b(0xf6))](Object[_0x42ab4b(0xff)](Object[_0x42ab4b(0xff)]({},Errors_1[_0x42ab4b(0x10b)][_0x42ab4b(0x10a)]),{'errMsg':Errors_1[_0x42ab4b(0x101)][_0x42ab4b(0x11c)]['update']['UPDATE_PARAM_OBJECT_ERROR']}));if((0x0,util_2[_0x42ab4b(0x119)])(_0x149453,_0x42ab4b(0x111)))throw new Errors_1['DataBaseError'](Object['assign'](Object[_0x42ab4b(0xff)]({},Errors_1['ERRORS']['INVALID_PARAM']),{'errMsg':Errors_1[_0x42ab4b(0x101)]['doc'][_0x42ab4b(0xf0)][_0x42ab4b(0x106)]}));const _0x5012e1=(0x0,util_2[_0x42ab4b(0x105)])({'_id':this['id']}),_0x4540d9={'collection_name':this['_coll'],'update_data':update_1['UpdateSerializer'][_0x42ab4b(0x10e)](_0x149453),'query':_0x5012e1,'query_type':constant_1[_0x42ab4b(0x12f)]['DOC'],'multi':![],'merge':!![],'upsert':![]},_0x54d237=await this[_0x42ab4b(0x12d)][_0x42ab4b(0x103)](_0x42ab4b(0x10d),(0x0,util_1[_0x42ab4b(0x12a)])(_0x4540d9));return{'updated':(_0x51c7e7=_0x54d237===null||_0x54d237===void 0x0?void 0x0:_0x54d237['updated'])!==null&&_0x51c7e7!==void 0x0?_0x51c7e7:0x0,'requestId':(_0x42cd6e=_0x54d237===null||_0x54d237===void 0x0?void 0x0:_0x54d237['request_id'])!==null&&_0x42cd6e!==void 0x0?_0x42cd6e:''};}async[a12_0x1a2f96(0x130)](){const _0x3547ec=a12_0x1a2f96;var _0x4074ad,_0xb992e9;const _0xaad6c5=(0x0,util_2[_0x3547ec(0x105)])({'_id':this['id']}),_0x4400fd={'collection_name':this[_0x3547ec(0xef)],'query':_0xaad6c5,'query_type':constant_1[_0x3547ec(0x12f)][_0x3547ec(0xfd)],'multi':![]},_0xa9136a=await this['_request'][_0x3547ec(0x103)](_0x3547ec(0x122),_0x4400fd);return{'deleted':(_0x4074ad=_0xa9136a[_0x3547ec(0x129)])!==null&&_0x4074ad!==void 0x0?_0x4074ad:0x0,'requestId':(_0xb992e9=_0xa9136a[_0x3547ec(0x104)])!==null&&_0xb992e9!==void 0x0?_0xb992e9:''};}}exports[a12_0x1a2f96(0x12b)]=DocumentReference;